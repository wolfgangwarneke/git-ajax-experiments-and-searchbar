@{ Boolean BillMurrayIsKingOfAllEarth = true; }
 
<link href="~/css/StyleSheet.css" type="text/css" rel="stylesheet" />   

<h2>Basic AJAX</h2>
<h4 class="hello-ajax">Hello AJAX</h4>
<div id="result1"></div>

<h2>Using Parameters</h2>
<h4 class="sum">Sum</h4>
<div id="result2"></div>

<h2>Using JSON to display an object</h2>
<h4 class="display-object">Display object</h4>
<div id="result3"></div>

<h2>Displaying a view</h2>
<h4 class="display-view">Display View</h4>
<div id="result4"></div>

<h2>Displaying a string</h2>
<input id="message" placeholder="type something here" />
<h4 class="messageToUpper">Click to Write Your Message... IN ALL CAPS</h4>
<div id="result5"></div>

<h2>Console log an integer</h2>
<h4 class="consoleLogInt">Click To Log It</h4>

@for (var i = 0; i < 13; i++)
{
    <hr />
}

<h2>Using a form to make a GET request</h2>
<form action="RandomDestinationList" class="display-random-database-items">
    <label for="destinationCount">How many destinations would you like to see?</label>
    <input type="number" name="destinationCount" />
    <button type="submit">Submit</button>
</form>
<div id="result6"></div>

<hr/>

@if (BillMurrayIsKingOfAllEarth)
{
    <h2>Submitting data with a POST request</h2>
    <form action="NewDestination" class="new-destination">
        <label for="newCity">City: </label>
        <input type="text" name="newCity" />
        <label for="newCountry">Country: </label>
        <input type="text" name="newCountry" />
        <button type="submit">Submit</button>
    </form>
    <div id="result6"></div>
}

<hr />

<form action="search" class="searchingForCities">
    <label for="name-query">Search for city name</label>
    <div>
        <input name="name-query" id="nameQuery" type="text" autocomplete="off"/>
        <div id="searchResultBox"></div>
    </div>
</form>
<p>Let's put something underneath</p>
<environment names="Development">
    <script src="~/lib/jquery/dist/jquery.js"></script>
    @*<script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>*@

</environment>

<script type="text/javascript">
    var numberOne;
    $(document).ready(function () {
        $('.hello-ajax').click(function () {
            $.ajax({
                type: 'GET',
                url: '@Url.Action("HelloAjax")',
                success: function (result) {
                    $('#result1').html(result);
                }
            });
        });
        $('.sum').click(function () {
            $.ajax({
                type: 'GET',
                data: { firstNumber: 1, secondNumber: 2 },
                url: '@Url.Action("Sum")',
                success: function (result) {
                    $('#result2').html(result);
                }
            });
        });
        $('.display-object').click(function () {
            $.ajax({
                type: 'GET',
                dataType: 'json',
                contentType: 'application/json',
                url: '@Url.Action("DisplayObject")',
                success: function (result) {
                    var resultString = "Id: " + result.id + "<br>City: " + result.city + "<br>Country: " + result.country;
                    $('#result3').html(resultString);
                }
            });
        });
        $(".display-view").click(function () {
            $.ajax({
                type: "GET",
                dataType: "html",
                url: '@Url.Action("DisplayViewWithAjax")',
                success: function (result) {
                    $('#result4').html(result);
                }
            });
        });
        $(".consoleLogInt").click(function () {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ReturnNumber1")',
                success: function (result) {
                    numberOne = result;
                    console.log(numberOne);
                }
            });
        });
        $(".messageToUpper").click(function () {
            $.ajax({
                type: "GET",
                dataType: "text",
                data: { message: $('#message').val() },
                url: '@Url.Action("GetMessageToUpper")',
                success: function (result) {
                    numberOne = result;
                    $('#result5').html(result.toUpperCase());
                }
            });
        });
        $('.display-random-database-items').submit(function (event) {
            event.preventDefault();
            $.ajax({
                url: '@Url.Action("RandomDestinationList")',
                type: 'GET',
                data: $(this).serialize(),
                dataType: 'json',
                success: function (result) {
                    var stringResult = '<ul>';
                    for (var i = 0; i < result.length; i++) {
                        stringResult += '<li>' + result[i].city + ", " + result[i].country + '</li>';
                    }
                    stringResult += '</ul>';
                    $('#result6').html(stringResult);
                }
            });
        });

        $('.new-destination').submit(function (event) {
            event.preventDefault();
            $.ajax({
                url: '@Url.Action("NewDestination")',
                type: 'POST',
                dataType: 'json',
                data: $(this).serialize(),
                success: function (result) {
                    var resultMessage = 'You\'ve added a new destination to the database!<br>Id: ' + result.id + '<br>City: ' + result.city + '<br>Country: ' + result.country;
                    $('#result6').html(resultMessage);
                }
            });
        });

        $('#nameQuery').keyup(function () {
            console.log('changed');
            $.ajax({
                url: '@Url.Action("SearchName")',
                type: 'GET',
                dataType: 'json',
                data: { nameQuery: $('#nameQuery').val() },
                success: function (result) {
                    console.log(result);
                    var stringResult = '<ul class="autoComplete">';
                    for (var i = 0; i < result.length; i++) {
                        stringResult += '<li>' + result[i].city + ", " + result[i].country + '</li>';
                    }
                    $('#searchResultBox').html(stringResult).show();
                    
                }
            });
        });
        $("#nameQuery").blur(function () {
            $("#searchResultBox").html("");
            $('#nameQuery').css("background-color", "#fff");
        });
        $("#nameQuery").click(function () {
            $('#nameQuery').css("background-color", "#f4f5ff");
        });

    });
</script>
